// RUN: %delta -print-ir %s | %FileCheck %s

struct S {
    let i: int;
    init() {}
    func f() {}
}

class C {
    let i: int;
    init() {}
    func f() {}
}

func s() -> S { return S(); }
func c() -> C { return C(); }

// CHECK-LABEL: define i32 @main()
func main() {
    // CHECK-NEXT: %1 = alloca %C
    // CHECK-NEXT: %2 = alloca %S
    // CHECK-NEXT: %3 = alloca %C

    // CHECK-NEXT: %4 = call %S @s()
    // CHECK-NEXT: call void @S.f(%S %4)
    s().f();

    // CHECK-NEXT: %5 = call %C @c()
    // CHECK-NEXT: store %C %5, %C* %1
    // CHECK-NEXT: call void @C.f(%C* %1)
    c().f();

    // CHECK-NEXT: call void @S.init(%S* %2)
    // CHECK-NEXT: %6 = load %S, %S* %2
    // CHECK-NEXT: call void @S.f(%S %6)
    S().f();

    // CHECK-NEXT: call void @C.init(%C* %3)
    // CHECK-NEXT: call void @C.f(%C* %3)
    C().f();

    // CHECK-NEXT: ret i32 0
}
